{% extends 'dashboard.html' %}

{% block content %}
<div id="full-page-container">
    <form method="post" class="row g-3"
          hx-post="{% if form.instance.pk %}{% url 'update_swot_report' form.instance.pk %}{% else %}{% url 'create_swot_report' %}{% endif %}"
          hx-target="#full-page-container"
          hx-swap="innerHTML"
          hx-push-url="true">
        {% csrf_token %}

        {% if messages %}
            {% for message in messages %}
                <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        <!-- Strategic Report Period -->
        <div class="col-md-6">
            {{ form.strategic_report_period.label_tag }}
            {{ form.strategic_report_period }}
        </div>

        <!-- SWOT Type -->
        <div class="col-md-4">
            <label>SWOT Type</label>
            <select name="swot_type" class="form-select"
                    hx-post="{% if form.instance.pk %}{% url 'update_swot_report' form.instance.pk %}{% else %}{% url 'create_swot_report' %}{% endif %}"
                    hx-target="#full-page-container"
                    hx-swap="innerHTML"
                    hx-trigger="change">
                {% for value, label in form.fields.swot_type.choices %}
                    <option value="{{ value }}"
                        {% if value == form.data.swot_type|default_if_none:form.instance.swot_type %}selected{% endif %}>
                        {{ label }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- SWOT Pillar -->
        <div class="col-md-4">
            <label>Pillar</label>
            <select name="swot_pillar" class="form-select"
                    hx-post="{% if form.instance.pk %}{% url 'update_swot_report' form.instance.pk %}{% else %}{% url 'create_swot_report' %}{% endif %}"
                    hx-target="#full-page-container"
                    hx-swap="innerHTML"
                    hx-trigger="change"
                    {% if form.fields.swot_pillar.widget.attrs.disabled %}disabled{% endif %}>
                {% for value, label in form.fields.swot_pillar.choices %}
                    <option value="{{ value }}"
                        {% if value == form.data.swot_pillar|default_if_none:form.instance.swot_pillar %}selected{% endif %}>
                        {{ label }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- SWOT Factor -->
        <div class="col-md-4">
            <label>Factor</label>
            <select name="swot_factor" class="form-select"
                    hx-post="{% if form.instance.pk %}{% url 'update_swot_report' form.instance.pk %}{% else %}{% url 'create_swot_report' %}{% endif %}"
                    hx-target="#full-page-container"
                    hx-swap="innerHTML"
                    {% if form.fields.swot_factor.widget.attrs.disabled %}disabled{% endif %}>
                {% for value, label in form.fields.swot_factor.choices %}
                    <option value="{{ value }}"
                        {% if value == form.data.swot_factor|default_if_none:form.instance.swot_factor %}selected{% endif %}>
                        {{ label }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- Priority / Impact / Likelihood -->
        <div class="col-md-4">
            {{ form.priority.label_tag }}
            {{ form.priority }}
        </div>
        <div class="col-md-4">
            {{ form.impact.label_tag }}
            {{ form.impact }}
        </div>
        <div class="col-md-4">
            {{ form.likelihood.label_tag }}
            {{ form.likelihood }}
        </div>

        <!-- Description -->
        <div class="col-12">
            {{ form.description.label_tag }}
            {{ form.description }}
        </div>

        <!-- Save / Cancel -->
        <div class="col-12 mt-3">
            <button type="submit" name="save" class="btn btn-success">
                Save
            </button>
            <a href="{% url 'swot_report_list' %}" class="btn btn-secondary"
               hx-get="{% url 'swot_report_list' %}"
               hx-target="#full-page-container"
               hx-swap="innerHTML"
               hx-push-url="true">
                Cancel
            </a>
        </div>
    </form>
</div>
{% endblock %}


